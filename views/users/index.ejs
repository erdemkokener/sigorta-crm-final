<div class="row justify-content-center">
  <div class="col-md-10">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h1 class="h3 mb-0">Kullanıcı Yönetimi</h1>
      <a href="/users/new" class="btn btn-primary"><i class="bi bi-person-plus"></i> Yeni Kullanıcı</a>
    </div>

    <% if (typeof msg !== 'undefined' && msg) { %>
      <div class="alert alert-success alert-dismissible fade show" role="alert">
        <%= msg %>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    <% } %>

    <% if (typeof error !== 'undefined' && error) { %>
      <div class="alert alert-danger alert-dismissible fade show" role="alert">
        <%= error %>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    <% } %>

    <div class="card shadow-sm">
      <div class="card-body">
        <table class="table table-striped align-middle">
          <thead>
            <tr>
              <th>Kullanıcı Adı</th>
              <th>Rol</th>
              <th>Durum</th>
              <th class="text-end">İşlemler</th>
            </tr>
          </thead>
          <tbody>
            <% if (!users || users.length === 0) { %>
              <tr>
                <td colspan="4" class="text-center text-muted">Henüz kullanıcı bulunmuyor.</td>
              </tr>
            <% } else { %>
              <% users.forEach(u => { %>
                <tr>
                  <td><%= u.username %></td>
                  <td>
                    <% if (u.role === 'owner') { %>
                      <span class="badge bg-dark">Ana Yönetici</span>
                    <% } else if (u.role === 'admin') { %>
                      <span class="badge bg-primary">Yönetici</span>
                    <% } else { %>
                      <span class="badge bg-secondary">Kullanıcı</span>
                    <% } %>
                  </td>
                  <td>
                    <% if (u.is_active === false) { %>
                      <span class="badge bg-danger">Pasif</span>
                    <% } else { %>
                      <span class="badge bg-success">Aktif</span>
                    <% } %>
                  </td>
                  <td class="text-end">
                    <div class="btn-group btn-group-sm">
                      <a href="/users/<%= u._id || u.id %>/edit" class="btn btn-outline-warning"><i class="bi bi-pencil"></i></a>
                      <% if (u.role !== 'owner') { %>
                        <form action="/users/<%= u._id || u.id %>/delete" method="post" class="d-inline" onsubmit="return confirm('Bu kullanıcıyı silmek istediğinize emin misiniz?')">
                          <button type="submit" class="btn btn-outline-danger"><i class="bi bi-trash"></i></button>
                        </form>
                      <% } %>
                    </div>
                  </td>
                </tr>
              <% }) %>
            <% } %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

